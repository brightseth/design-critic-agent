<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Mastery Critique Studio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #000;
            --secondary: #111;
            --accent: #fff;
            --text-primary: #fff;
            --text-secondary: #999;
            --text-muted: #666;
            --border: #222;
            --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-4: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --gradient-5: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #000;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.03;
            background: 
                radial-gradient(circle at 20% 50%, #667eea 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, #764ba2 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, #f093fb 0%, transparent 50%);
            animation: bgMove 20s ease-in-out infinite;
        }

        @keyframes bgMove {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(-20px, -20px) scale(1.1); }
            66% { transform: translate(20px, -10px) scale(0.9); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
        }

        /* Header with animated text */
        .header {
            text-align: center;
            margin-bottom: 80px;
            position: relative;
        }

        h1 {
            font-size: clamp(48px, 8vw, 72px);
            font-weight: 100;
            letter-spacing: -2px;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
        }

        .header h1 span {
            display: inline-block;
            animation: titleFloat 3s ease-in-out infinite;
            animation-delay: calc(var(--i) * 0.1s);
        }

        @keyframes titleFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .subtitle {
            font-size: 20px;
            color: #666;
            font-weight: 300;
            opacity: 0;
            animation: fadeInUp 1s ease-out 0.5s forwards;
        }

        /* Main upload area with glassmorphism */
        .upload-section {
            background: rgba(17, 17, 17, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            animation: fadeInScale 0.8s ease-out;
        }

        .upload-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
            pointer-events: auto;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .upload-area:hover {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.02);
            transform: scale(1.02);
        }

        .upload-area.dragover {
            border-color: #fff;
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        /* Mode selector */
        .mode-selector {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .mode-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 100px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            position: relative;
            overflow: hidden;
        }

        .mode-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .mode-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .mode-btn.active {
            background: #fff;
            color: #000;
            font-weight: 500;
        }

        /* Analysis progress */
        .analysis-progress {
            display: none;
            margin: 40px 0;
        }

        .progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-1);
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .progress-stages {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }

        .stage {
            flex: 1;
            text-align: center;
            opacity: 0.3;
            transition: all 0.3s ease;
        }

        .stage.active {
            opacity: 1;
            transform: scale(1.1);
        }

        .stage-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .stage.active .stage-icon {
            background: var(--gradient-1);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        /* Preview with annotations */
        .preview-section {
            display: none;
            margin-bottom: 60px;
            animation: fadeInUp 0.6s ease-out;
        }

        .preview-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }

        @media (max-width: 1024px) {
            .preview-container {
                grid-template-columns: 1fr;
            }
        }

        .preview-image-container {
            position: relative;
            background: #111;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
        }

        .preview-image {
            width: 100%;
            max-width: 500px;
            max-height: 400px;
            object-fit: contain;
            display: block;
            cursor: crosshair;
            margin: 0 auto;
        }

        .annotation-marker {
            position: absolute;
            width: 32px;
            height: 32px;
            background: var(--gradient-2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            transform: translate(-50%, -50%);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        .annotation-panel {
            background: rgba(17, 17, 17, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .annotation-item {
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            margin-bottom: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .annotation-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        /* Critique cards with ratings */
        .critique-section {
            display: none;
            margin-bottom: 60px;
        }

        .critique-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .critic-card {
            background: rgba(17, 17, 17, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            transform: translateY(20px);
            opacity: 0;
            animation: slideUpFade 0.6s ease-out forwards;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .critic-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .critic-card.expanded {
            padding: 40px;
        }
        
        .hot-take {
            font-size: 18px;
            line-height: 1.4;
            color: #fff;
            margin: 20px 0;
            font-weight: 300;
            padding: 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border-left: 3px solid var(--gradient-color);
        }
        
        .critic-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .critic-details.expanded {
            max-height: 500px;
        }
        
        .expand-indicator {
            text-align: center;
            margin-top: 16px;
            color: #666;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .expand-indicator:hover {
            color: #999;
        }

        .critic-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient);
        }

        .critic-card:nth-child(1) { --gradient: var(--gradient-1); animation-delay: 0.1s; }
        .critic-card:nth-child(2) { --gradient: var(--gradient-2); animation-delay: 0.2s; }
        .critic-card:nth-child(3) { --gradient: var(--gradient-3); animation-delay: 0.3s; }
        .critic-card:nth-child(4) { --gradient: var(--gradient-4); animation-delay: 0.4s; }
        .critic-card:nth-child(5) { --gradient: var(--gradient-5); animation-delay: 0.5s; }

        .critic-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .critic-info {
            display: flex;
            align-items: center;
        }

        .critic-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient);
            margin-right: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 300;
            color: #fff;
            position: relative;
            background-size: cover;
            background-position: center;
            overflow: hidden;
        }
        
        .critic-avatar.has-image {
            background-image: var(--avatar-url);
        }
        
        .critic-avatar.has-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1;
        }
        
        /* Fallback for broken images */
        .critic-avatar.has-image {
            background-image: var(--avatar-url), var(--gradient);
        }
        
        .critic-avatar span {
            position: relative;
            z-index: 2;
        }

        .critic-avatar::after {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: var(--gradient);
            border-radius: 50%;
            z-index: -1;
            opacity: 0.3;
            filter: blur(10px);
        }

        .rating-circle {
            width: 80px;
            height: 80px;
            position: relative;
        }

        .rating-svg {
            transform: rotate(-90deg);
        }

        .rating-bg {
            fill: none;
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 8;
        }

        .rating-fill {
            fill: none;
            stroke: url(#gradient);
            stroke-width: 8;
            stroke-linecap: round;
            stroke-dasharray: 220;
            stroke-dashoffset: 220;
            transition: stroke-dashoffset 1.5s ease-out;
        }

        .rating-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            font-weight: 600;
        }

        /* Interactive improvements panel */
        .improvements-panel {
            background: rgba(17, 17, 17, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 40px;
        }

        .improvement-category {
            margin-bottom: 30px;
        }

        .improvement-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            cursor: pointer;
        }

        .improvement-header:hover {
            opacity: 0.8;
        }

        .improvement-items {
            display: grid;
            gap: 16px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .improvement-items.expanded {
            max-height: 500px;
        }

        .improvement-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            display: flex;
            align-items: start;
            gap: 16px;
            transition: all 0.3s ease;
        }

        .improvement-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .improvement-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            cursor: pointer;
            position: relative;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .improvement-checkbox.checked {
            background: var(--gradient-3);
            border: none;
        }

        .improvement-checkbox.checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-weight: bold;
        }

        /* Score breakdown */
        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .score-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 16px;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .score-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-5px);
        }

        .score-value {
            font-size: 48px;
            font-weight: 100;
            margin-bottom: 10px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .score-label {
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Design principles with examples */
        .principles-section {
            margin-top: 80px;
        }

        .principles-tabs {
            display: flex;
            gap: 20px;
            margin-bottom: 40px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .principle-tab {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 100px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .principle-tab.active {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .principle-content {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .principle-content.active {
            display: block;
        }

        .example-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .example-card {
            background: rgba(17, 17, 17, 0.9);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .example-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .example-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .example-content {
            padding: 20px;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes slideUpFade {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Interactive tutorial */
        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(5px);
        }

        .tutorial-spotlight {
            position: absolute;
            border-radius: 16px;
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.5);
            transition: all 0.5s ease;
        }

        .tutorial-tooltip {
            position: absolute;
            background: #fff;
            color: #000;
            padding: 20px;
            border-radius: 12px;
            max-width: 300px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* Loading states */
        .skeleton {
            background: linear-gradient(90deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 100%);
            background-size: 200% 100%;
            animation: skeleton 1.5s ease-in-out infinite;
        }

        @keyframes skeleton {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Critic selector */
        .critic-selector {
            background: rgba(17, 17, 17, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeInUp 0.5s ease-out;
        }

        .critic-categories {
            display: grid;
            gap: 30px;
        }

        .critic-category {
            background: rgba(255, 255, 255, 0.02);
            padding: 20px;
            border-radius: 16px;
        }

        .critic-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .critic-chip {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 100px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .critic-chip:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .critic-chip input {
            display: none;
        }

        .critic-chip input:checked + span {
            color: #000;
            font-weight: 500;
        }

        .critic-chip input:checked ~ .critic-chip {
            background: #fff;
            color: #000;
        }

        .critic-chip:has(input:checked) {
            background: #fff;
            color: #000;
            border-color: #fff;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .critique-grid {
                grid-template-columns: 1fr;
            }
            
            .upload-section {
                padding: 40px 20px;
            }
            
            .score-breakdown {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* URL input styling */
        .url-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            color: #fff;
            font-size: 13px;
            margin-top: 12px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .url-input:focus {
            border-color: rgba(255,255,255,0.3);
            background: rgba(0,0,0,0.7);
        }
        
        .url-input::placeholder {
            color: rgba(255,255,255,0.5);
        }
        
        /* File input styling */
        #fileInput {
            display: none;
        }
        
        /* Ensure URL input is clickable */
        #urlInput {
            position: relative;
            z-index: 10;
            pointer-events: auto;
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <div class="container">
        <div class="header">
            <h1>
                <span style="--i: 0">C</span><span style="--i: 1">r</span><span style="--i: 2">i</span><span style="--i: 3">t</span><span style="--i: 4">i</span><span style="--i: 5">c</span>
                <span style="--i: 6">S</span><span style="--i: 7">t</span><span style="--i: 8">u</span><span style="--i: 9">d</span><span style="--i: 10">i</span><span style="--i: 11">o</span>
            </h1>
            <p class="subtitle">AI-Powered Critique from World-Renowned Experts</p>
        </div>

        <!-- Mode selector for different critique types -->
        <div class="mode-selector" style="margin-bottom: 30px;">
            <button class="mode-btn active" data-mode="design" onclick="switchCritiqueMode('design')">
                <span style="font-size: 20px; margin-right: 8px;">🎨</span> Design
            </button>
            <button class="mode-btn" data-mode="photo" onclick="switchCritiqueMode('photo')">
                <span style="font-size: 20px; margin-right: 8px;">📷</span> Photography
            </button>
            <button class="mode-btn" data-mode="art" onclick="switchCritiqueMode('art')">
                <span style="font-size: 20px; margin-right: 8px;">🖼️</span> Art
            </button>
        </div>

        <div class="critic-selector" id="criticSelector" style="display: none; margin-bottom: 40px;">
            <h3 style="font-size: 24px; font-weight: 300; margin-bottom: 20px;">Select Your Design Critics</h3>
            <div class="critic-categories">
                <div class="critic-category">
                    <h4 style="color: #666; font-size: 14px; text-transform: uppercase; margin-bottom: 15px;">Modernist Masters</h4>
                    <div class="critic-chips">
                        <label class="critic-chip">
                            <input type="checkbox" value="vignelli" checked>
                            <span>Massimo Vignelli</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="rand">
                            <span>Paul Rand</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="bass">
                            <span>Saul Bass</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="glaser">
                            <span>Milton Glaser</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="fletcher">
                            <span>Alan Fletcher</span>
                        </label>
                    </div>
                </div>
                <div class="critic-category">
                    <h4 style="color: #666; font-size: 14px; text-transform: uppercase; margin-bottom: 15px;">Typography Experts</h4>
                    <div class="critic-chips">
                        <label class="critic-chip">
                            <input type="checkbox" value="scher" checked>
                            <span>Paula Scher</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="lubalin">
                            <span>Herb Lubalin</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="fili">
                            <span>Louise Fili</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="miedinger">
                            <span>Max Miedinger</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="trochut">
                            <span>Alex Trochut</span>
                        </label>
                    </div>
                </div>
                <div class="critic-category">
                    <h4 style="color: #666; font-size: 14px; text-transform: uppercase; margin-bottom: 15px;">Contemporary Voices</h4>
                    <div class="critic-chips">
                        <label class="critic-chip">
                            <input type="checkbox" value="walsh" checked>
                            <span>Jessica Walsh</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="sagmeister">
                            <span>Stefan Sagmeister</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="carson">
                            <span>David Carson</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="moross">
                            <span>Aries Moross</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="greiman">
                            <span>April Greiman</span>
                        </label>
                    </div>
                </div>
                <div class="critic-category">
                    <h4 style="color: #666; font-size: 14px; text-transform: uppercase; margin-bottom: 15px;">Specialized Expertise</h4>
                    <div class="critic-chips">
                        <label class="critic-chip">
                            <input type="checkbox" value="kidd">
                            <span>Chip Kidd (Book Covers)</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="kare">
                            <span>Susan Kare (Icons)</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="saville">
                            <span>Peter Saville (Album Art)</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="tanamachi">
                            <span>Dana Tanamachi (Lettering)</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="bierut">
                            <span>Michael Bierut (Identity)</span>
                        </label>
                    </div>
                </div>
                <div class="critic-category">
                    <h4 style="color: #666; font-size: 14px; text-transform: uppercase; margin-bottom: 15px;">Tech & Product</h4>
                    <div class="critic-chips">
                        <label class="critic-chip">
                            <input type="checkbox" value="jobs" checked>
                            <span>Steve Jobs</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="ive">
                            <span>Jony Ive</span>
                        </label>
                        <label class="critic-chip">
                            <input type="checkbox" value="maeda">
                            <span>John Maeda</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div class="upload-section">
            <div class="upload-area" id="uploadArea">
                <input type="file" id="fileInput" accept="image/*" multiple>
                <div style="font-size: 24px;">📐</div>
                <div>
                    <div style="font-size: 16px; margin-bottom: 4px;">Drop design here or click to browse</div>
                    <div style="color: #666; font-size: 12px;">Supports multiple files • JPG, PNG, GIF</div>
                </div>
            </div>
            <input type="text" class="url-input" id="urlInput" placeholder="Or paste any URL (example.com, figma.com, dribbble.com, etc.)">
        </div>

        <div class="analysis-progress" id="analysisProgress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-stages">
                <div class="stage" data-stage="1">
                    <div class="stage-icon">👁️</div>
                    <div>Visual Analysis</div>
                </div>
                <div class="stage" data-stage="2">
                    <div class="stage-icon">🎨</div>
                    <div>Color & Typography</div>
                </div>
                <div class="stage" data-stage="3">
                    <div class="stage-icon">📐</div>
                    <div>Layout & Grid</div>
                </div>
                <div class="stage" data-stage="4">
                    <div class="stage-icon">✨</div>
                    <div>Principles Check</div>
                </div>
                <div class="stage" data-stage="5">
                    <div class="stage-icon">💡</div>
                    <div>Generating Insights</div>
                </div>
            </div>
        </div>

        <div class="preview-section" id="previewSection">
            <h2 style="font-size: 32px; font-weight: 300; margin-bottom: 30px;">Design Analysis</h2>
            
            <!-- Image Description Section -->
            <div id="imageDescription" style="background: rgba(17, 17, 17, 0.9); backdrop-filter: blur(10px); border-radius: 16px; padding: 30px; margin-bottom: 30px; border: 1px solid rgba(255, 255, 255, 0.1); display: none;">
                <h3 style="font-size: 20px; margin-bottom: 16px; color: #fff;">What I'm Looking At:</h3>
                <p id="designDescription" style="color: #ccc; line-height: 1.6; margin-bottom: 16px;">Analyzing your design...</p>
                <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                    <div>
                        <span style="color: #666; font-size: 12px; text-transform: uppercase;">Type:</span>
                        <span id="designType" style="color: #fff; margin-left: 8px;">Web Interface</span>
                    </div>
                    <div>
                        <span style="color: #666; font-size: 12px; text-transform: uppercase;">Colors:</span>
                        <span id="designColors" style="color: #fff; margin-left: 8px;">Blue, White, Gray</span>
                    </div>
                    <div>
                        <span style="color: #666; font-size: 12px; text-transform: uppercase;">Elements:</span>
                        <span id="designElements" style="color: #fff; margin-left: 8px;">Navigation, Hero, Typography</span>
                    </div>
                </div>
            </div>
            
            <div class="preview-container">
                <div class="preview-image-container" id="imageContainer">
                    <img id="previewImage" class="preview-image" alt="Design preview">
                    <!-- Annotation markers will be added here -->
                </div>
                <div class="annotation-panel">
                    <h3 style="margin-bottom: 20px; font-weight: 400;">Key Observations</h3>
                    <div id="annotationsList">
                        <div class="annotation-item">
                            <strong>1.</strong> Click on the image to add observation markers
                        </div>
                        <div class="annotation-item">
                            <strong>2.</strong> Visual hierarchy assessment pending
                        </div>
                        <div class="annotation-item">
                            <strong>3.</strong> Color palette analysis in progress
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="score-breakdown" id="scoreBreakdown" style="display: none;">
            <div class="score-card">
                <div class="score-value" id="score1" style="background: var(--gradient-1); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">0</div>
                <div class="score-label" id="scoreLabel1">Composition</div>
            </div>
            <div class="score-card">
                <div class="score-value" id="score2" style="background: var(--gradient-2); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">0</div>
                <div class="score-label" id="scoreLabel2">Impact</div>
            </div>
            <div class="score-card">
                <div class="score-value" id="score3" style="background: var(--gradient-3); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">0</div>
                <div class="score-label" id="scoreLabel3">Execution</div>
            </div>
        </div>

        <div class="critique-section" id="critiqueSection">
            <h2 style="font-size: 32px; font-weight: 300; margin-bottom: 30px;">Expert Critiques</h2>
            <div class="critique-grid" id="critiqueGrid">
                <!-- Critiques will be dynamically inserted here -->
            </div>
        </div>

        <div class="improvements-panel" id="improvementsPanel" style="display: none;">
            <h2 style="font-size: 32px; font-weight: 300; margin-bottom: 30px;">Actionable Improvements</h2>
            
            <div class="improvement-category">
                <div class="improvement-header" onclick="toggleCategory('visual')">
                    <h3>Visual Hierarchy</h3>
                    <span>▼</span>
                </div>
                <div class="improvement-items" id="visual-items">
                    <!-- Improvements will be added here -->
                </div>
            </div>

            <div class="improvement-category">
                <div class="improvement-header" onclick="toggleCategory('typography')">
                    <h3>Typography</h3>
                    <span>▼</span>
                </div>
                <div class="improvement-items" id="typography-items">
                    <!-- Improvements will be added here -->
                </div>
            </div>

            <div class="improvement-category">
                <div class="improvement-header" onclick="toggleCategory('color')">
                    <h3>Color & Contrast</h3>
                    <span>▼</span>
                </div>
                <div class="improvement-items" id="color-items">
                    <!-- Improvements will be added here -->
                </div>
            </div>

            <div class="improvement-category">
                <div class="improvement-header" onclick="toggleCategory('layout')">
                    <h3>Layout & Spacing</h3>
                    <span>▼</span>
                </div>
                <div class="improvement-items" id="layout-items">
                    <!-- Improvements will be added here -->
                </div>
            </div>
        </div>

        <div class="principles-section">
            <h2 id="deepDiveTitle" style="font-size: 32px; font-weight: 300; margin-bottom: 30px;">Design Principles Deep Dive</h2>
            
            <div class="principles-tabs" id="principlesTabs">
                <div class="principle-tab active" onclick="showPrinciple('jobs')">Steve Jobs</div>
                <div class="principle-tab" onclick="showPrinciple('maeda')">John Maeda</div>
                <div class="principle-tab" onclick="showPrinciple('vignelli')">Massimo Vignelli</div>
                <div class="principle-tab" onclick="showPrinciple('rand')">Paul Rand</div>
                <div class="principle-tab" onclick="showPrinciple('scher')">Paula Scher</div>
                <div class="principle-tab" onclick="showPrinciple('carson')">David Carson</div>
                <div class="principle-tab" onclick="showPrinciple('glaser')">Milton Glaser</div>
                <div class="principle-tab" onclick="showPrinciple('walsh')">Jessica Walsh</div>
                <div class="principle-tab" onclick="showPrinciple('sagmeister')">Stefan Sagmeister</div>
            </div>

            <div class="principle-content active" id="principle-jobs">
                <h3 style="font-size: 24px; margin-bottom: 20px;">The Jobs Philosophy: Simplicity is the Ultimate Sophistication</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Steve Jobs believed that true simplicity comes from deeply understanding the essence of a product and ruthlessly eliminating everything that doesn't serve its core purpose. It's not about minimalism for its own sake, but about clarity of thought and purpose.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%); display: flex; align-items: center; justify-content: center; color: #666; font-size: 16px;">🎵 Original iPod</div>
                        <div class="example-content">
                            <h4>Original iPod (2001)</h4>
                            <p style="color: #666; font-size: 14px;">1,000 songs in your pocket. Revolutionary simplicity in both interface and industrial design.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #000 0%, #333 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">📱 Original iPhone</div>
                        <div class="example-content">
                            <h4>Original iPhone (2007)</h4>
                            <p style="color: #666; font-size: 14px;">Eliminated physical keyboard, single home button. Design is not just what it looks like—design is how it works.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #00d4ff 0%, #0099cc 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🖥️ iMac Evolution</div>
                        <div class="example-content">
                            <h4>iMac Evolution</h4>
                            <p style="color: #666; font-size: 14px;">From colorful iMac G3 to ultra-thin modern design. Continuous refinement toward essence.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="principle-content" id="principle-vignelli">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Vignelli's Canon: Discipline & Appropriateness</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Massimo Vignelli championed timeless design through discipline, appropriateness, and ambiguity. His work proves that constraints breed creativity and that good design lasts forever.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🚇 NYC Subway Map</div>
                        <div class="example-content">
                            <h4>NYC Subway Map (1972)</h4>
                            <p style="color: #666; font-size: 14px;">Revolutionary grid-based transit map. Helvetica only. Information design perfection.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #c8102e 0%, #a50e26 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">✈️ American Airlines</div>
                        <div class="example-content">
                            <h4>American Airlines (1967)</h4>
                            <p style="color: #666; font-size: 14px;">Timeless logotype using Helvetica. Simple, functional, appropriate. Still in use today.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🪑 Knoll Furniture</div>
                        <div class="example-content">
                            <h4>Knoll Furniture (1966)</h4>
                            <p style="color: #666; font-size: 14px;">Modernist grid system, restrained color, systematic typography. Pure discipline.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="principle-content" id="principle-rand">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Paul Rand: The Play Instinct</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Paul Rand believed design must be functional but also surprising. His logos for IBM, ABC, and UPS demonstrate how simplicity and wit can create timeless identities.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #1f70c1 0%, #0f5499 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 24px; font-weight: bold;">IBM</div>
                        <div class="example-content">
                            <h4>IBM Logo (1956)</h4>
                            <p style="color: #666; font-size: 14px;">Simple, weighty, authoritative. Later evolved to striped version. Timeless corporate identity.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #000 0%, #333 100%); display: flex; align-items: center; justify-content: center;"><div style="width: 60px; height: 60px; border-radius: 50%; background: #fff; display: flex; align-items: center; justify-content: center; color: #000; font-weight: bold;">abc</div></div>
                        <div class="example-content">
                            <h4>ABC Logo (1962)</h4>
                            <p style="color: #666; font-size: 14px;">Perfect circle, simple typography. Geometric clarity with surprising memorability.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #8B4513 0%, #5d2f0a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">📦 UPS Shield</div>
                        <div class="example-content">
                            <h4>UPS Shield (1961)</h4>
                            <p style="color: #666; font-size: 14px;">Heraldic shield suggests reliability and tradition. Form perfectly matches function.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="principle-content" id="principle-scher">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Paula Scher: Typography as Architecture</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Paula Scher treats typography as environmental design. Her work for The Public Theater and environmental graphics show how type can create space, emotion, and identity at massive scales.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #ff0040 0%, #cc0033 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px; text-align: center;">🎭<br>PUBLIC<br>THEATER</div>
                        <div class="example-content">
                            <h4>The Public Theater (1994)</h4>
                            <p style="color: #666; font-size: 14px;">Bold typography as primary image. Wood type inspiration. Typography as architecture.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #da020e 0%, #b5010b 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 20px; font-weight: bold;">citi</div>
                        <div class="example-content">
                            <h4>Citibank Identity (1998)</h4>
                            <p style="color: #666; font-size: 14px;">Dynamic red arc. Typography system that scales from business cards to buildings.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 14px; text-align: center;">🌍<br>WINDOWS<br>ON THE<br>WORLD</div>
                        <div class="example-content">
                            <h4>Windows on the World (2000)</h4>
                            <p style="color: #666; font-size: 14px;">Environmental graphics at World Trade Center. Typography integrated into space.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="principle-content" id="principle-carson">
                <h3 style="font-size: 24px; margin-bottom: 20px;">David Carson: End of Print</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    David Carson revolutionized graphic design by breaking every rule. His work for Ray Gun magazine proved that illegibility could be more communicative than clarity when it serves the message.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Emotional Typography</h4>
                            <p style="color: #666; font-size: 14px;">Don't mistake legibility for communication.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Intuitive Design</h4>
                            <p style="color: #666; font-size: 14px;">Never learned the rules, so I don't know which ones I'm breaking.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Deconstruction</h4>
                            <p style="color: #666; font-size: 14px;">The more you pull apart and layer, the more the message comes through.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="principle-content" id="principle-glaser">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Milton Glaser: Design & Love</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Milton Glaser brought warmth and humanity to modernist design. Creator of "I ♥ NY" and co-founder of New York Magazine, he believed design should create relationships between people.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Generosity</h4>
                            <p style="color: #666; font-size: 14px;">There are three responses to design: yes, no, and WOW! Wow is the one to aim for.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Art in Design</h4>
                            <p style="color: #666; font-size: 14px;">To design is to communicate clearly by whatever means you can control.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Social Impact</h4>
                            <p style="color: #666; font-size: 14px;">Good design is good citizenship. Design must serve people, not manipulate them.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="principle-content" id="principle-walsh">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Jessica Walsh: Emotional Boldness</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Jessica Walsh brings unprecedented boldness to contemporary design. Her work combines digital-first thinking with tactile experimentation, creating experiences that demand attention.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Digital + Physical</h4>
                            <p style="color: #666; font-size: 14px;">The best ideas live at the intersection of digital and physical experiences.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Maximalism</h4>
                            <p style="color: #666; font-size: 14px;">Sometimes more is more. Don't be afraid of color, pattern, and excess when it serves the story.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Personal Work</h4>
                            <p style="color: #666; font-size: 14px;">Side projects keep your creative soul alive. They're where you push boundaries.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="principle-content" id="principle-sagmeister">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Stefan Sagmeister: Beauty & Happiness</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Stefan Sagmeister challenges the notion that design must be neutral. His deeply personal work proves that beauty, emotion, and even pain can create more meaningful communication.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Beauty Works</h4>
                            <p style="color: #666; font-size: 14px;">Beauty is not superficial. It's a core human need that makes life worth living.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Personal Risk</h4>
                            <p style="color: #666; font-size: 14px;">The more personal the work, the more universal it becomes.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>Sabbaticals</h4>
                            <p style="color: #666; font-size: 14px;">Taking time off is not luxury, it's necessity for creative renewal.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="principle-content" id="principle-maeda">
                <h3 style="font-size: 24px; margin-bottom: 20px;">John Maeda: Laws of Simplicity</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    John Maeda's Ten Laws of Simplicity provide a systematic approach to reducing complexity while maintaining functionality. His work bridges technology and design with clear principles.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>REDUCE</h4>
                            <p style="color: #666; font-size: 14px;">The simplest way to achieve simplicity is through thoughtful reduction.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>ORGANIZE</h4>
                            <p style="color: #666; font-size: 14px;">Organization makes a system of many appear fewer.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image skeleton" style="height: 200px;"></div>
                        <div class="example-content">
                            <h4>TIME</h4>
                            <p style="color: #666; font-size: 14px;">Savings in time feel like simplicity.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Photography Masters Content -->
            <div class="principle-content" id="principle-cartier-bresson" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Henri Cartier-Bresson: The Decisive Moment</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    The father of modern photojournalism believed in capturing the precise moment when the visual and emotional elements come together in perfect harmony.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">📷 Behind Gare Saint-Lazare</div>
                        <div class="example-content">
                            <h4>Perfect Timing (1932)</h4>
                            <p style="color: #666; font-size: 14px;">The leap frozen at the exact moment before impact.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #4a4a4a 0%, #2a2a2a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🌍 Street Photography</div>
                        <div class="example-content">
                            <h4>Rue Mouffetard (1954)</h4>
                            <p style="color: #666; font-size: 14px;">Candid moments without intrusion.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #6a6a6a 0%, #3a3a3a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">✨ Visual Rhythm</div>
                        <div class="example-content">
                            <h4>Cyclades, Greece (1961)</h4>
                            <p style="color: #666; font-size: 14px;">Geometric patterns creating visual music.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="principle-content" id="principle-leibovitz" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Annie Leibovitz: Environmental Portraits</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Master of celebrity portraiture who uses environment and staging to reveal character and create iconic, narrative-driven images.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #8B4513 0%, #5d2f0a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">👑 John & Yoko</div>
                        <div class="example-content">
                            <h4>Last Portrait (1980)</h4>
                            <p style="color: #666; font-size: 14px;">Intimate vulnerability hours before tragedy.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #4B0082 0%, #2a0042 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🎭 Theatrical Staging</div>
                        <div class="example-content">
                            <h4>Vanity Fair Covers</h4>
                            <p style="color: #666; font-size: 14px;">Elaborate productions revealing essence.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #1f70c1 0%, #0f5499 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🏊 Underwater Queen</div>
                        <div class="example-content">
                            <h4>Queen Elizabeth II (2007)</h4>
                            <p style="color: #666; font-size: 14px;">Royal protocol meets artistic vision.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="principle-content" id="principle-avedon" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Richard Avedon: Stark Revelation</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Stripped backgrounds to reveal psychological truth. His white backdrop became a stage where subjects confronted themselves.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%); display: flex; align-items: center; justify-content: center; color: #333; font-size: 16px;">⬜ White Space</div>
                        <div class="example-content">
                            <h4>In The American West</h4>
                            <p style="color: #666; font-size: 14px;">Working class heroes on white.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="principle-content" id="principle-arbus" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Diane Arbus: The Strange in the Familiar</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Found beauty in marginalized subjects, challenging conventional notions of normalcy through direct, unflinching portraits.
                </p>
            </div>
            
            <div class="principle-content" id="principle-salgado" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Sebastião Salgado: Epic Humanity</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Documents human dignity in challenging conditions with biblical scope and classical composition.
                </p>
            </div>
            
            <div class="principle-content" id="principle-sherman" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Cindy Sherman: Constructed Identity</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Uses herself as model to explore identity, representation, and the construction of femininity in media.
                </p>
            </div>
            
            <div class="principle-content" id="principle-mann" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Sally Mann: Southern Gothic Memory</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Explores family, mortality, and the American South through deeply personal, often controversial imagery.
                </p>
            </div>
            
            <div class="principle-content" id="principle-gursky" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Andreas Gursky: Massive Scale</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Creates enormous, detailed tableaux that reveal patterns of contemporary global capitalism.
                </p>
            </div>
            
            <!-- Art Critics Content -->
            <div class="principle-content" id="principle-saltz" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Jerry Saltz: Art for Everyone</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Pulitzer Prize-winning critic who democratizes art criticism. Believes art should be felt, not just understood.
                </p>
                <div class="example-grid">
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #ff6b6b 0%, #cc5555 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🎨 Emotional Impact</div>
                        <div class="example-content">
                            <h4>"How to Be an Artist"</h4>
                            <p style="color: #666; font-size: 14px;">33 rules for making art that matters.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #4ecdc4 0%, #3aa39a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🗣️ Direct Voice</div>
                        <div class="example-content">
                            <h4>Instagram Criticism</h4>
                            <p style="color: #666; font-size: 14px;">Making art accessible on social media.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="principle-content" id="principle-smith" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Roberta Smith: Formalist Eye</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    New York Times co-chief art critic known for visual intelligence and championing emerging artists.
                </p>
            </div>
            
            <div class="principle-content" id="principle-obrist" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Hans Ulrich Obrist: Global Conversations</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Curator who sees art as urgent global dialogue. Known for marathon interviews and experimental exhibitions.
                </p>
            </div>
            
            <div class="principle-content" id="principle-golden" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Thelma Golden: Cultural Vision</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Director of Studio Museum in Harlem, champion of Black artists and post-Black art movement.
                </p>
            </div>
            
            <div class="principle-content" id="principle-bourriaud" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Nicolas Bourriaud: Relational Aesthetics</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Theorist of art as social interstice - creating spaces for human relations.
                </p>
            </div>
            
            <div class="principle-content" id="principle-bishop" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Claire Bishop: Participatory Critique</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Challenges the social turn in art, questioning who really participates and who benefits.
                </p>
            </div>
            
            <div class="principle-content" id="principle-danto" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Arthur Danto: After the End of Art</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Philosopher who argued art history ended with Warhol - now anything can be art in the right context.
                </p>
            </div>
            
            <div class="principle-content" id="principle-enwezor" style="display: none;">
                <h3 style="font-size: 24px; margin-bottom: 20px;">Okwui Enwezor: Postcolonial Perspectives</h3>
                <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                    Late curator who decentered Western art narratives, bringing African and global South perspectives to major institutions.
                </p>
            </div>
        </div>
    </div>

    <div class="tutorial-overlay" id="tutorialOverlay">
        <div class="tutorial-spotlight" id="tutorialSpotlight"></div>
        <div class="tutorial-tooltip" id="tutorialTooltip">
            <h4>Welcome to Design Mastery!</h4>
            <p>Let's take a quick tour of the features...</p>
            <button onclick="nextTutorialStep()">Next</button>
            <button onclick="closeTutorial()">Skip</button>
        </div>
    </div>

    <script>
        // Initialize the application
        let currentCritiqueMode = 'design'; // 'design', 'photo', or 'art'
        let uploadedImages = [];
        let annotations = [];
        let currentStage = 0;
        let critiqueData = {};

        // Function to switch between Design, Photo, and Art modes
        function switchCritiqueMode(mode) {
            currentCritiqueMode = mode;
            
            // Update button states
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.mode === mode) {
                    btn.classList.add('active');
                }
            });
            
            // Update UI text based on mode
            const subtitle = document.querySelector('.subtitle');
            const uploadText = document.querySelector('#uploadArea h3');
            const deepDiveTitle = document.getElementById('deepDiveTitle');
            const principlesTabs = document.getElementById('principlesTabs');
            
            if (mode === 'photo') {
                subtitle.textContent = 'AI-Powered Photography Critique from Master Photographers';
                if (uploadText) uploadText.textContent = 'Drop Your Photo';
                if (deepDiveTitle) deepDiveTitle.textContent = 'Photography Masters Deep Dive';
                updatePrincipleTabs('photo');
            } else if (mode === 'art') {
                subtitle.textContent = 'AI-Powered Art Critique from Renowned Curators & Critics';
                if (uploadText) uploadText.textContent = 'Drop Your Artwork';
                if (deepDiveTitle) deepDiveTitle.textContent = 'Art Critics & Curators Deep Dive';
                updatePrincipleTabs('art');
            } else {
                subtitle.textContent = 'AI-Powered Design Critique from the Masters';
                if (uploadText) uploadText.textContent = 'Drop Your Design';
                if (deepDiveTitle) deepDiveTitle.textContent = 'Design Principles Deep Dive';
                updatePrincipleTabs('design');
            }
            
            console.log('Switched to', mode, 'mode');
        }
        
        // Function to update principle tabs based on mode
        function updatePrincipleTabs(mode) {
            const principlesTabs = document.getElementById('principlesTabs');
            if (!principlesTabs) return;
            
            let tabsHTML = '';
            
            if (mode === 'photo') {
                // Photography masters
                tabsHTML = `
                    <div class="principle-tab active" onclick="showPrinciple('cartier-bresson')">Henri Cartier-Bresson</div>
                    <div class="principle-tab" onclick="showPrinciple('leibovitz')">Annie Leibovitz</div>
                    <div class="principle-tab" onclick="showPrinciple('avedon')">Richard Avedon</div>
                    <div class="principle-tab" onclick="showPrinciple('arbus')">Diane Arbus</div>
                    <div class="principle-tab" onclick="showPrinciple('salgado')">Sebastião Salgado</div>
                    <div class="principle-tab" onclick="showPrinciple('sherman')">Cindy Sherman</div>
                    <div class="principle-tab" onclick="showPrinciple('mann')">Sally Mann</div>
                    <div class="principle-tab" onclick="showPrinciple('gursky')">Andreas Gursky</div>
                `;
                updatePrincipleContent('photo');
            } else if (mode === 'art') {
                // Art critics and curators
                tabsHTML = `
                    <div class="principle-tab active" onclick="showPrinciple('saltz')">Jerry Saltz</div>
                    <div class="principle-tab" onclick="showPrinciple('smith')">Roberta Smith</div>
                    <div class="principle-tab" onclick="showPrinciple('obrist')">Hans Ulrich Obrist</div>
                    <div class="principle-tab" onclick="showPrinciple('golden')">Thelma Golden</div>
                    <div class="principle-tab" onclick="showPrinciple('bourriaud')">Nicolas Bourriaud</div>
                    <div class="principle-tab" onclick="showPrinciple('bishop')">Claire Bishop</div>
                    <div class="principle-tab" onclick="showPrinciple('danto')">Arthur Danto</div>
                    <div class="principle-tab" onclick="showPrinciple('enwezor')">Okwui Enwezor</div>
                `;
                updatePrincipleContent('art');
            } else {
                // Design masters (default)
                tabsHTML = `
                    <div class="principle-tab active" onclick="showPrinciple('jobs')">Steve Jobs</div>
                    <div class="principle-tab" onclick="showPrinciple('maeda')">John Maeda</div>
                    <div class="principle-tab" onclick="showPrinciple('vignelli')">Massimo Vignelli</div>
                    <div class="principle-tab" onclick="showPrinciple('rand')">Paul Rand</div>
                    <div class="principle-tab" onclick="showPrinciple('scher')">Paula Scher</div>
                    <div class="principle-tab" onclick="showPrinciple('carson')">David Carson</div>
                    <div class="principle-tab" onclick="showPrinciple('glaser')">Milton Glaser</div>
                    <div class="principle-tab" onclick="showPrinciple('walsh')">Jessica Walsh</div>
                    <div class="principle-tab" onclick="showPrinciple('sagmeister')">Stefan Sagmeister</div>
                `;
                // Keep existing design content
            }
            
            principlesTabs.innerHTML = tabsHTML;
        }
        
        // Function to update principle content based on mode
        function updatePrincipleContent(mode) {
            // Find or create a container for dynamic principle content
            let contentContainer = document.querySelector('.principles-section .principle-content.active');
            if (!contentContainer) return;
            
            if (mode === 'photo') {
                contentContainer.innerHTML = `
                    <h3 style="font-size: 24px; margin-bottom: 20px;">Henri Cartier-Bresson: The Decisive Moment</h3>
                    <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                        The father of modern photojournalism believed in capturing the precise moment when the visual and emotional elements of a scene come together in perfect harmony. His concept of the "decisive moment" revolutionized photography.
                    </p>
                    <div class="example-grid">
                        <div class="example-card">
                            <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">📷 Geometric Composition</div>
                            <div class="example-content">
                                <h4>Behind Gare Saint-Lazare (1932)</h4>
                                <p style="color: #666; font-size: 14px;">Perfect timing meets geometric composition. The leap frozen at the exact moment before impact.</p>
                            </div>
                        </div>
                        <div class="example-card">
                            <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #4a4a4a 0%, #2a2a2a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🌍 Street Photography</div>
                            <div class="example-content">
                                <h4>Rue Mouffetard (1954)</h4>
                                <p style="color: #666; font-size: 14px;">Candid street photography capturing authentic human moments without intrusion.</p>
                            </div>
                        </div>
                        <div class="example-card">
                            <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #6a6a6a 0%, #3a3a3a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">✨ Visual Rhythm</div>
                            <div class="example-content">
                                <h4>Cyclades, Greece (1961)</h4>
                                <p style="color: #666; font-size: 14px;">Geometric patterns and human forms creating visual music in black and white.</p>
                            </div>
                        </div>
                    </div>
                `;
            } else if (mode === 'art') {
                contentContainer.innerHTML = `
                    <h3 style="font-size: 24px; margin-bottom: 20px;">Jerry Saltz: Art for the People</h3>
                    <p style="color: #999; line-height: 1.8; margin-bottom: 30px;">
                        Pulitzer Prize-winning critic Jerry Saltz democratizes art criticism with his passionate, accessible approach. He believes art should punch you in the gut, not require a PhD to understand.
                    </p>
                    <div class="example-grid">
                        <div class="example-card">
                            <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #ff6b6b 0%, #cc5555 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🎨 Emotional Impact</div>
                            <div class="example-content">
                                <h4>"How to Be an Artist" (2020)</h4>
                                <p style="color: #666; font-size: 14px;">33 rules including: "Art is not about understanding. It's about experience."</p>
                            </div>
                        </div>
                        <div class="example-card">
                            <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #4ecdc4 0%, #3aa39a 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">🗣️ Direct Voice</div>
                            <div class="example-content">
                                <h4>Instagram Criticism</h4>
                                <p style="color: #666; font-size: 14px;">Bringing art criticism to social media. "The art world is not the art market."</p>
                            </div>
                        </div>
                        <div class="example-card">
                            <div class="example-image" style="height: 200px; background: linear-gradient(135deg, #f7b731 0%, #d4991f 100%); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px;">✨ Accessibility</div>
                            <div class="example-content">
                                <h4>New York Magazine</h4>
                                <p style="color: #666; font-size: 14px;">Making contemporary art accessible: "All art is contemporary art."</p>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // File upload handlers
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const urlInput = document.getElementById('urlInput');

        uploadArea.addEventListener('click', () => fileInput.click());
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            const files = Array.from(e.dataTransfer.files);
            handleFiles(files);
        });

        fileInput.addEventListener('change', (e) => {
            const files = Array.from(e.target.files);
            handleFiles(files);
        });
        
        urlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && e.target.value.trim()) {
                handleURL(e.target.value.trim());
            }
        });
        
        urlInput.addEventListener('blur', (e) => {
            if (e.target.value.trim()) {
                handleURL(e.target.value.trim());
            }
        });

        function handleFiles(files) {
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            
            imageFiles.forEach(file => {
                // Compress image before adding to uploadedImages
                compressImage(file, (compressedDataUrl) => {
                    uploadedImages.push({
                        url: compressedDataUrl,
                        name: file.name,
                        file: file
                    });
                    
                    if (uploadedImages.length === 1) {
                        // Show first image
                        showPreview(uploadedImages[0].url);
                    }
                    
                    if (imageFiles.length === uploadedImages.length) {
                        // All files loaded, start analysis
                        startAnalysis();
                    }
                });
            });
        }
        
        function handleURL(url) {
            // Basic URL validation - just check if it's a valid URL format
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url; // Add https if missing
            }
            
            try {
                new URL(url);
            } catch {
                alert('Please enter a valid URL');
                return;
            }
            
            uploadedImages = []; // Clear previous images
            uploadedImages.push({
                url: url,
                name: 'URL Image',
                isUrl: true
            });
            
            showPreview(url);
            startAnalysis();
            
            // Clear the input
            urlInput.value = '';
        }

        function compressImage(file, callback) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const img = new Image();
            
            img.onload = function() {
                // Calculate new dimensions (max 800px on longest side)
                let { width, height } = img;
                const maxSize = 800;
                
                if (width > height && width > maxSize) {
                    height = (height * maxSize) / width;
                    width = maxSize;
                } else if (height > maxSize) {
                    width = (width * maxSize) / height;
                    height = maxSize;
                }
                
                canvas.width = width;
                canvas.height = height;
                
                // Draw and compress
                ctx.drawImage(img, 0, 0, width, height);
                const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.8);
                callback(compressedDataUrl);
            };
            
            const reader = new FileReader();
            reader.onload = (e) => img.src = e.target.result;
            reader.readAsDataURL(file);
        }

        function showPreview(imageUrl) {
            const previewSection = document.getElementById('previewSection');
            const previewImage = document.getElementById('previewImage');
            const imageContainer = document.getElementById('imageContainer');
            
            // Check if it's a direct image URL or a website URL
            const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.svg'];
            const isDirectImage = imageExtensions.some(ext => imageUrl.toLowerCase().includes(ext));
            
            if (isDirectImage || imageUrl.startsWith('data:image')) {
                // Direct image URL or base64
                previewImage.src = imageUrl;
                previewImage.style.display = 'block';
            } else {
                // Website URL - hide image and show placeholder
                previewImage.style.display = 'none';
                previewImage.src = ''; // Clear any previous src to prevent loading errors
                
                // Create a placeholder for website URLs
                const existingPlaceholder = document.getElementById('urlPlaceholder');
                if (existingPlaceholder) {
                    existingPlaceholder.remove();
                }
                
                const placeholder = document.createElement('div');
                placeholder.id = 'urlPlaceholder';
                placeholder.style.cssText = `
                    width: 100%;
                    max-width: 500px;
                    height: 300px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    border-radius: 12px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    text-align: center;
                    padding: 20px;
                    margin: 0 auto;
                `;
                placeholder.innerHTML = `
                    <div style="font-size: 48px; margin-bottom: 16px;">🌐</div>
                    <div style="font-size: 18px; margin-bottom: 8px;">Analyzing Website</div>
                    <div style="font-size: 14px; opacity: 0.9; word-break: break-all; max-width: 400px;">${imageUrl}</div>
                    <div style="font-size: 12px; opacity: 0.7; margin-top: 16px;">Design analysis in progress...</div>
                `;
                imageContainer.appendChild(placeholder);
            }
            
            previewSection.style.display = 'block';
            
            // Enable click to add annotations only for actual images
            if (isDirectImage || imageUrl.startsWith('data:image')) {
                previewImage.addEventListener('click', addAnnotation);
            }
        }

        function addAnnotation(e) {
            const rect = e.target.getBoundingClientRect();
            const x = ((e.clientX - rect.left) / rect.width) * 100;
            const y = ((e.clientY - rect.top) / rect.height) * 100;
            
            const annotationId = annotations.length + 1;
            annotations.push({
                id: annotationId,
                x: x,
                y: y,
                text: `Observation ${annotationId}`
            });
            
            // Add marker
            const marker = document.createElement('div');
            marker.className = 'annotation-marker';
            marker.style.left = `${x}%`;
            marker.style.top = `${y}%`;
            marker.textContent = annotationId;
            marker.onclick = () => highlightAnnotation(annotationId);
            
            document.getElementById('imageContainer').appendChild(marker);
            
            // Add to list
            updateAnnotationsList();
        }

        function updateAnnotationsList(observations = null) {
            const list = document.getElementById('annotationsList');
            
            // If we have observations from the API, display them
            if (observations && observations.length > 0) {
                list.innerHTML = observations.map((obs, index) => `
                    <div class="annotation-item">
                        <strong>${index + 1}.</strong> ${obs}
                    </div>
                `).join('');
            } else if (annotations.length === 0) {
                // Generate mode-specific default observations
                generateModeSpecificObservations();
            } else {
                list.innerHTML = annotations.map(ann => `
                    <div class="annotation-item" onclick="highlightAnnotation(${ann.id})">
                        <strong>${ann.id}.</strong> ${ann.text}
                    </div>
                `).join('');
            }
        }
        
        function generateModeSpecificObservations() {
            const list = document.getElementById('annotationsList');
            let observations = [];
            
            if (currentCritiqueMode === 'photo') {
                observations = [
                    'Examining photographic composition and framing',
                    'Analyzing light quality and emotional narrative',
                    'Assessing technical execution and moment capture'
                ];
            } else if (currentCritiqueMode === 'art') {
                observations = [
                    'Evaluating conceptual framework and artistic intent',
                    'Analyzing material choices and cultural context',
                    'Assessing innovation and contribution to discourse'
                ];
            } else {
                observations = [
                    'Analyzing visual hierarchy and user flow',
                    'Evaluating typography and color harmony',
                    'Assessing functional clarity and brand consistency'
                ];
            }
            
            list.innerHTML = observations.map((obs, index) => `
                <div class="annotation-item">
                    <strong>${index + 1}.</strong> ${obs}
                </div>
            `).join('');
        }

        function highlightAnnotation(id) {
            // Highlight logic here
            console.log(`Highlighting annotation ${id}`);
        }

        function startAnalysis() {
            const progress = document.getElementById('analysisProgress');
            progress.style.display = 'block';
            
            const stages = 5;
            let currentStage = 0;
            
            // Make API call here
            if (uploadedImages.length > 0) {
                const firstImage = uploadedImages[0];
                if (firstImage.isUrl) {
                    // It's a URL, pass it as URL
                    analyzeImage(null, firstImage.url);
                } else {
                    // It's base64 data
                    analyzeImage(firstImage.url, null);
                }
            }
            
            const stageInterval = setInterval(() => {
                currentStage++;
                updateProgress(currentStage, stages);
                
                if (currentStage >= stages) {
                    clearInterval(stageInterval);
                    setTimeout(() => {
                        progress.style.display = 'none';
                        showResults();
                    }, 500);
                }
            }, 1000);
        }
        
        async function analyzeImage(imageData, imageUrl) {
            try {
                const payload = {
                    mode: currentCritiqueMode // Send the critique mode (design/photo/art)
                };
                
                // Determine if it's a URL or base64 data
                if (imageUrl) {
                    payload.imageUrl = imageUrl;
                } else {
                    payload.imageData = imageData;
                }
                
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                
                const result = await response.json();
                if (result.success) {
                    critiqueData = result;
                    // Show image description
                    if (result.imageAnalysis) {
                        showImageDescription(result.imageAnalysis);
                    }
                    // Update Key Observations based on mode and actual data
                    if (result.observations && result.observations.length > 0) {
                        updateAnnotationsList(result.observations);
                    } else {
                        // Generate mode-specific observations if not provided
                        generateModeSpecificObservations();
                    }
                    // Store critique data for later display
                    if (result.critique) {
                        window.apiCritiques = result.critique;
                    }
                    // Store recommendations for improvements
                    if (result.recommendations) {
                        window.apiRecommendations = result.recommendations;
                    }
                } else {
                    console.error('Analysis failed:', result.error);
                    // Still show mock data for demo
                    showImageDescription({
                        description: "A modern web interface with clean typography and structured layout",
                        designType: "Web Interface",
                        primaryColors: ["Blue", "White", "Gray"],
                        elements: ["Navigation", "Hero Section", "Call-to-Action"]
                    });
                }
            } catch (error) {
                console.error('Network error:', error);
            }
        }
        
        function showImageDescription(analysis) {
            const descSection = document.getElementById('imageDescription');
            const descText = document.getElementById('designDescription');
            const typeText = document.getElementById('designType');
            const colorsText = document.getElementById('designColors');
            const elementsText = document.getElementById('designElements');
            
            if (descSection && analysis) {
                descSection.style.display = 'block';
                if (descText) descText.textContent = analysis.description || 'Analyzing your design...';
                if (typeText) typeText.textContent = analysis.designType || 'Interface';
                if (colorsText) colorsText.textContent = (analysis.primaryColors || []).join(', ') || 'Various';
                if (elementsText) elementsText.textContent = (analysis.elements || []).join(', ') || 'Multiple';
            }
        }

        function updateProgress(current, total) {
            const percentage = (current / total) * 100;
            document.getElementById('progressFill').style.width = `${percentage}%`;
            
            // Update stage indicators
            document.querySelectorAll('.stage').forEach((stage, index) => {
                if (index < current) {
                    stage.classList.add('active');
                } else {
                    stage.classList.remove('active');
                }
            });
        }

        function showResults() {
            // Show score breakdown with animation
            const scoreBreakdown = document.getElementById('scoreBreakdown');
            scoreBreakdown.style.display = 'grid';
            
            // Update score labels based on mode
            updateScoreLabels();
            
            // Animate scores (3 scores instead of 5)
            animateScore('score1', Math.floor(Math.random() * 20) + 70);
            animateScore('score2', Math.floor(Math.random() * 20) + 65);
            animateScore('score3', Math.floor(Math.random() * 20) + 75);
            
            // Show critiques
            generateCritiques();
            
            // Show improvements
            generateImprovements();
        }
        
        function updateScoreLabels() {
            const label1 = document.getElementById('scoreLabel1');
            const label2 = document.getElementById('scoreLabel2');
            const label3 = document.getElementById('scoreLabel3');
            
            if (currentCritiqueMode === 'photo') {
                if (label1) label1.textContent = 'Composition';
                if (label2) label2.textContent = 'Narrative';
                if (label3) label3.textContent = 'Technical';
            } else if (currentCritiqueMode === 'art') {
                if (label1) label1.textContent = 'Concept';
                if (label2) label2.textContent = 'Execution';
                if (label3) label3.textContent = 'Relevance';
            } else {
                if (label1) label1.textContent = 'Simplicity';
                if (label2) label2.textContent = 'Impact';
                if (label3) label3.textContent = 'Usability';
            }
        }

        function animateScore(elementId, targetScore) {
            const element = document.getElementById(elementId);
            let currentScore = 0;
            const increment = targetScore / 50;
            
            const interval = setInterval(() => {
                currentScore += increment;
                if (currentScore >= targetScore) {
                    currentScore = targetScore;
                    clearInterval(interval);
                }
                element.textContent = Math.round(currentScore);
            }, 20);
        }

        function displayAPICritiques(critics) {
            const critiqueGrid = document.getElementById('critiqueGrid');
            
            critiqueGrid.innerHTML = critics.map((critic, index) => {
                const gradientVar = `--gradient-${(index % 5) + 1}`;
                
                return `
                <div class="critic-card" onclick="toggleCriticCard(${index})">
                    <div class="critic-header">
                        <div class="critic-info">
                            <div class="critic-avatar ${critic.avatarUrl ? 'has-image' : ''}" style="background: var(${gradientVar}); ${critic.avatarUrl ? `--avatar-url: url('${critic.avatarUrl}');` : ''}">
                                <span>${critic.avatar}</span>
                            </div>
                            <div>
                                <div style="font-size: 20px; font-weight: 500;">${critic.name}</div>
                                <div style="color: #666; font-size: 14px;">${critic.title}</div>
                            </div>
                        </div>
                        <div class="rating-circle">
                            <svg class="rating-svg" width="80" height="80">
                                <defs>
                                    <linearGradient id="gradient-${index}">
                                        <stop offset="0%" stop-color="#667eea" />
                                        <stop offset="100%" stop-color="#764ba2" />
                                    </linearGradient>
                                </defs>
                                <circle class="rating-bg" cx="40" cy="40" r="35"></circle>
                                <circle class="rating-fill" cx="40" cy="40" r="35" 
                                    style="stroke: url(#gradient-${index}); stroke-dashoffset: ${220 - (220 * (critic.score || 75) / 100)}">
                                </circle>
                            </svg>
                            <div class="rating-text">${critic.score || 75}</div>
                        </div>
                    </div>
                    
                    <!-- Acknowledgment of what they see -->
                    ${critic.acknowledgment ? `
                        <div style="padding: 12px 16px; background: rgba(255,255,255,0.02); border-radius: 8px; margin-bottom: 12px; color: #999; font-style: italic; font-size: 14px;">
                            👁️ ${critic.acknowledgment}
                        </div>
                    ` : ''}
                    
                    <!-- Hot Take - Always Visible -->
                    <div class="hot-take" style="--gradient-color: var(${gradientVar});">
                        💬 "${critic.hotTake || 'Analyzing your design...'}"
                    </div>
                    
                    <!-- Expandable Details -->
                    <div class="critic-details" id="critic-details-${index}">
                        ${critic.points ? critic.points.map(point => {
                            let color, label;
                            if (point.type === 'positive' || point.type === 'strength') {
                                color = '#4facfe';
                                label = '✅ Strength';
                            } else if (point.type === 'negative' || point.type === 'weakness') {
                                color = '#f093fb';
                                label = '⚠️ Weakness';
                            } else {
                                color = '#43e97b';
                                label = '💡 Suggestion';
                            }
                            return `
                                <div style="margin-bottom: 12px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 8px; border-left: 2px solid ${color};">
                                    <div style="font-size: 11px; color: ${color}; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 1px;">${label}</div>
                                    <span style="color: #ccc;">${point.text}</span>
                                </div>
                            `;
                        }).join('') : ''}
                    </div>
                    
                    <div class="expand-indicator">
                        <span id="expand-text-${index}">Click for detailed feedback ▼</span>
                    </div>
                </div>
            `}).join('');
            
            // Add toggle function if not exists
            if (!window.toggleCriticCard) {
                window.toggleCriticCard = function(index) {
                    const details = document.getElementById(`critic-details-${index}`);
                    const expandText = document.getElementById(`expand-text-${index}`);
                    const card = document.querySelectorAll('.critic-card')[index];
                    
                    if (details) {
                        details.classList.toggle('expanded');
                        card.classList.toggle('expanded');
                        if (expandText) {
                            expandText.textContent = details.classList.contains('expanded') 
                                ? 'Click to collapse ▲' 
                                : 'Click for detailed feedback ▼';
                        }
                    }
                };
            }
        }
        
        function generateCritiques() {
            const critiqueSection = document.getElementById('critiqueSection');
            const critiqueGrid = document.getElementById('critiqueGrid');
            
            critiqueSection.style.display = 'block';
            
            // Use API critique data if available (stored in window.apiCritiques)
            if (window.apiCritiques && window.apiCritiques.length > 0) {
                displayAPICritiques(window.apiCritiques);
                return;
            }
            
            // Also check critiqueData for backwards compatibility
            if (critiqueData && critiqueData.critique && critiqueData.critique.length > 0) {
                displayAPICritiques(critiqueData.critique);
                return;
            }
            
            // Extended list of design critics
            const allCritics = [
                {
                    name: 'Steve Jobs',
                    avatar: 'SJ',
                    title: 'Simplicity & Soul',
                    gradient: '--gradient-1',
                    rating: 78,
                    avatarUrl: 'https://cdn.britannica.com/04/171104-050-AEFE3141/Steve-Jobs-2010.jpg',
                    specialty: 'Product Design Philosophy',
                    focus: 'Examining the essence and focus of your design...',
                    strengths: [
                        'Clear primary action that guides the user\'s attention',
                        'Good use of negative space in key areas'
                    ],
                    weaknesses: [
                        'Too many competing visual elements dilute the core message',
                        'The typography hierarchy could be more decisive',
                        'Consider removing 40% of the current elements'
                    ],
                    suggestions: [
                        'Identify the ONE thing users should remember and make everything else support it',
                        'Use bolder type contrasts - whisper or shout, never just talk',
                        'Each element should earn its place through multiple iterations'
                    ]
                },
                {
                    name: 'Massimo Vignelli',
                    avatar: 'MV',
                    title: 'Timeless Modernism',
                    gradient: '--gradient-2',
                    rating: 85,
                    avatarUrl: 'https://www.printmag.com/wp-content/uploads/2016/05/massimo_vignelli_portrait.jpg',
                    specialty: 'Grid Systems & Typography',
                    focus: 'Evaluating the discipline and structure of your design...',
                    strengths: [
                        'Attempt at systematic approach is evident',
                        'Some consistency in spacing'
                    ],
                    weaknesses: [
                        'The grid is not strict enough - embrace the discipline',
                        'Too many typefaces - we designed the NYC subway with one',
                        'Decoration without purpose - if it\'s not useful, it\'s not beautiful'
                    ],
                    suggestions: [
                        'Use only Helvetica, Garamond, Bodoni, or Century - nothing else needed',
                        'Implement a strict modular grid - no exceptions',
                        'Remove all decorative elements that don\'t serve information'
                    ]
                },
                {
                    name: 'Saul Bass',
                    avatar: 'SB',
                    title: 'Visual Storytelling',
                    gradient: '--gradient-3',
                    rating: 72,
                    avatarUrl: 'https://www.printmag.com/wp-content/uploads/2015/05/saul-bass-portrait.jpg',
                    specialty: 'Logo Design & Motion',
                    focus: 'Looking for the story and symbolism in your design...',
                    strengths: [
                        'Some attempt at visual metaphor',
                        'Movement suggested in static elements'
                    ],
                    weaknesses: [
                        'The core symbol/idea isn\'t clear enough',
                        'Missing the "aha" moment of recognition',
                        'Too literal - great design suggests rather than tells'
                    ],
                    suggestions: [
                        'Distill your concept to a single symbolic shape',
                        'Think in sequences - how does this design move?',
                        'Create tension through asymmetry and unexpected crops'
                    ]
                },
                {
                    name: 'David Carson',
                    avatar: 'DC',
                    title: 'Deconstructed Expression',
                    gradient: '--gradient-4',
                    rating: 65,
                    avatarUrl: 'https://www.printmag.com/wp-content/uploads/2015/08/david-carson-portrait.jpg',
                    specialty: 'Experimental Typography',
                    focus: 'Checking for emotional impact and rule-breaking...',
                    strengths: [
                        'Some visual energy present',
                        'Not completely predictable'
                    ],
                    weaknesses: [
                        'Too safe - where\'s the rebellion?',
                        'Typography is too legible (yes, that can be a problem)',
                        'Following rules that should be broken'
                    ],
                    suggestions: [
                        'Make it more difficult to read if it makes it more interesting to look at',
                        'Layer, overlap, fragment - create visual noise with purpose',
                        'Don\'t explain everything - let viewers work for meaning'
                    ]
                },
                {
                    name: 'Milton Glaser',
                    avatar: 'MG',
                    title: 'Humanist Design',
                    gradient: '--gradient-5',
                    rating: 75,
                    avatarUrl: 'https://www.printmag.com/wp-content/uploads/2020/06/milton-glaser-portrait.jpg',
                    specialty: 'Illustration & Identity',
                    focus: 'Searching for warmth and human connection...',
                    strengths: [
                        'Some personality showing through',
                        'Attempts at creating emotional resonance'
                    ],
                    weaknesses: [
                        'Lacks the human touch - feels too mechanical',
                        'Missing joy and surprise',
                        'Color choices are too safe and expected'
                    ],
                    suggestions: [
                        'Add hand-drawn elements or custom lettering',
                        'Use color to create unexpected emotional responses',
                        'Design is about creating relationships - make it personal'
                    ]
                },
                {
                    name: 'Paul Rand',
                    avatar: 'PR',
                    title: 'Modernist Principles',
                    gradient: '--gradient-1',
                    rating: 80,
                    avatarUrl: 'https://www.printmag.com/wp-content/uploads/2016/08/paul-rand-portrait.jpg',
                    specialty: 'Corporate Identity',
                    focus: 'Analyzing the logic and playfulness balance...',
                    strengths: [
                        'Clear attempt at problem-solving',
                        'Some geometric clarity'
                    ],
                    weaknesses: [
                        'Lacks the "simple yet quirky" quality of great logos',
                        'Too many ideas competing - pick one and perfect it',
                        'Missing the element of surprise'
                    ],
                    suggestions: [
                        'A logo is a flag, not a novel - simplify drastically',
                        'Add one unexpected element that makes it memorable',
                        'Test at business card size - does it still work?'
                    ]
                },
                {
                    name: 'Paula Scher',
                    avatar: 'PS',
                    title: 'Typography as Image',
                    gradient: '--gradient-2',
                    rating: 77,
                    avatarUrl: 'https://www.printmag.com/wp-content/uploads/2017/03/paula-scher-portrait.jpg',
                    specialty: 'Environmental Graphics',
                    focus: 'Examining typography as architecture...',
                    strengths: [
                        'Type has some presence on the page',
                        'Attempting to use scale'
                    ],
                    weaknesses: [
                        'Typography isn\'t bold enough - GO BIG',
                        'Not enough contrast in scales',
                        'Type should BE the image, not decorate it'
                    ],
                    suggestions: [
                        'Make type so large it becomes abstract pattern',
                        'Layer typography to create depth and dimension',
                        'Think of letters as shapes first, readable second'
                    ]
                },
                {
                    name: 'Susan Kare',
                    avatar: 'SK',
                    title: 'Pixel Perfect Icons',
                    gradient: '--gradient-3',
                    rating: 70,
                    avatarUrl: 'https://www.computerhistory.org/timeline/images/1983_susankare_sm.jpg',
                    specialty: 'Interface Design',
                    focus: 'Evaluating clarity at small sizes and universal understanding...',
                    strengths: [
                        'Some recognition of icon importance',
                        'Attempts at visual consistency'
                    ],
                    weaknesses: [
                        'Icons aren\'t instantly recognizable',
                        'Too much detail for small sizes',
                        'Metaphors aren\'t universal enough'
                    ],
                    suggestions: [
                        'Design icons on a 32x32 pixel grid first',
                        'Remove details until it breaks, then add one back',
                        'Test with people from different cultures - does it translate?'
                    ]
                },
                {
                    name: 'Jessica Walsh',
                    avatar: 'JW',
                    title: 'Bold & Playful',
                    gradient: '--gradient-4',
                    rating: 68,
                    avatarUrl: 'https://www.printmag.com/wp-content/uploads/2018/02/jessica-walsh-portrait.jpg',
                    specialty: 'Art Direction',
                    focus: 'Looking for boldness and contemporary relevance...',
                    strengths: [
                        'Some color courage evident',
                        'Trying to be contemporary'
                    ],
                    weaknesses: [
                        'Not Instagram-worthy - where\'s the wow factor?',
                        'Playing it too safe with trends',
                        'Missing the unexpected juxtaposition'
                    ],
                    suggestions: [
                        'Add one element that makes people stop scrolling',
                        'Mix high and low culture references',
                        'Use color combinations that shouldn\'t work but do'
                    ]
                },
                {
                    name: 'Chip Kidd',
                    avatar: 'CK',
                    title: 'Conceptual Clarity',
                    gradient: '--gradient-5',
                    rating: 74,
                    specialty: 'Book Cover Design',
                    focus: 'Searching for the big idea...',
                    strengths: [
                        'Some conceptual thinking visible',
                        'Attempting visual metaphor'
                    ],
                    weaknesses: [
                        'The concept isn\'t clear in 2 seconds',
                        'Too much explanation needed',
                        'Missing the "chip shot" - that perfect visual pun'
                    ],
                    suggestions: [
                        'What\'s the one image that tells the whole story?',
                        'Clarity or mystery, not both - pick a lane',
                        'Make it work as a thumbnail first'
                    ]
                },
                {
                    name: 'Stefan Sagmeister',
                    avatar: 'SS',
                    title: 'Provocative Beauty',
                    gradient: '--gradient-1',
                    rating: 66,
                    avatarUrl: 'https://www.printmag.com/wp-content/uploads/2015/09/stefan-sagmeister-portrait.jpg',
                    specialty: 'Experiential Design',
                    focus: 'Looking for emotional and physical engagement...',
                    strengths: [
                        'Some visual interest',
                        'Not completely boring'
                    ],
                    weaknesses: [
                        'Where\'s the provocation? The discomfort?',
                        'Too polite - design should make you feel something',
                        'Missing the handmade, human element'
                    ],
                    suggestions: [
                        'Add an element that makes people uncomfortable',
                        'Consider how this exists in physical space',
                        'Break at least three design rules meaningfully'
                    ]
                },
                {
                    name: 'Louise Fili',
                    avatar: 'LF',
                    title: 'Elegant Typography',
                    gradient: '--gradient-2',
                    rating: 73,
                    specialty: 'Restaurant Identity',
                    focus: 'Examining sophistication and craft...',
                    strengths: [
                        'Some attention to detail',
                        'Attempting elegance'
                    ],
                    weaknesses: [
                        'Typography lacks the Italian restaurant menu elegance',
                        'Not enough historical reference and reverence',
                        'Missing the handcrafted quality'
                    ],
                    suggestions: [
                        'Study vernacular typography from the appropriate era',
                        'Add subtle ornamental elements that enhance, not distract',
                        'Perfect the letter spacing - it\'s everything'
                    ]
                }
            ];
            
            // Select a subset of critics based on the mode or randomly
            let selectedCritics;
            if (currentMode === 'comprehensive') {
                // Select 6-8 varied critics for comprehensive analysis
                selectedCritics = [
                    allCritics[0], // Steve Jobs
                    allCritics[1], // Massimo Vignelli
                    allCritics[4], // Milton Glaser
                    allCritics[6], // Paula Scher
                    allCritics[7], // Susan Kare
                    allCritics[8], // Jessica Walsh
                ];
            } else if (currentMode === 'quick') {
                // Select 3 critics for quick review
                selectedCritics = [
                    allCritics[0], // Steve Jobs
                    allCritics[5], // Paul Rand
                    allCritics[6], // Paula Scher
                ];
            } else {
                // Random selection
                selectedCritics = allCritics.sort(() => 0.5 - Math.random()).slice(0, 5);
            }
            
            const critics = selectedCritics;
            
            critiqueGrid.innerHTML = critics.map((critic, index) => `
                <div class="critic-card" style="${critic.gradient}">
                    <div class="critic-header">
                        <div class="critic-info">
                            <div class="critic-avatar ${critic.avatarUrl ? 'has-image' : ''}" style="background: var(${critic.gradient}); ${critic.avatarUrl ? `--avatar-url: url('${critic.avatarUrl}');` : ''}">
                                <span>${critic.avatar}</span>
                            </div>
                            <div>
                                <div style="font-size: 20px; font-weight: 500;">${critic.name}</div>
                                <div style="color: #666; font-size: 14px;">${critic.title}</div>
                            </div>
                        </div>
                        <div class="rating-circle">
                            <svg class="rating-svg" width="80" height="80">
                                <defs>
                                    <linearGradient id="gradient-${index}">
                                        <stop offset="0%" stop-color="#667eea" />
                                        <stop offset="100%" stop-color="#764ba2" />
                                    </linearGradient>
                                </defs>
                                <circle class="rating-bg" cx="40" cy="40" r="35"></circle>
                                <circle class="rating-fill" cx="40" cy="40" r="35" 
                                    style="stroke: url(#gradient-${index}); stroke-dashoffset: ${220 - (220 * critic.rating / 100)}">
                                </circle>
                            </svg>
                            <div class="rating-text">${critic.rating}</div>
                        </div>
                    </div>
                    <div style="margin-top: 30px;">
                        <p style="color: #888; margin-bottom: 20px; font-style: italic;">${critic.focus}</p>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: #4facfe; margin-bottom: 10px;">Strengths</h4>
                            ${critic.strengths.map(s => `<div style="margin-bottom: 8px; padding-left: 20px; color: #ccc;">• ${s}</div>`).join('')}
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: #f093fb; margin-bottom: 10px;">Areas for Improvement</h4>
                            ${critic.weaknesses.map(w => `<div style="margin-bottom: 8px; padding-left: 20px; color: #ccc;">• ${w}</div>`).join('')}
                        </div>
                        
                        <div>
                            <h4 style="color: #43e97b; margin-bottom: 10px;">Specific Suggestions</h4>
                            ${critic.suggestions.map(s => `<div style="margin-bottom: 8px; padding-left: 20px; color: #ccc;">• ${s}</div>`).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function generateImprovements() {
            const panel = document.getElementById('improvementsPanel');
            panel.style.display = 'block';
            
            // Generate mode-specific improvements based on critique data
            let improvements = {};
            
            if (currentCritiqueMode === 'photo') {
                improvements = generatePhotoImprovements();
            } else if (currentCritiqueMode === 'art') {
                improvements = generateArtImprovements();
            } else {
                improvements = generateDesignImprovements();
            }
            
            // Update category labels based on mode
            updateImprovementCategories();
            
            Object.entries(improvements).forEach(([category, items]) => {
                const container = document.getElementById(`${category}-items`);
                if (container) {
                    container.innerHTML = items.map((item, index) => `
                    <div class="improvement-item">
                        <div class="improvement-checkbox" onclick="toggleImprovement(this)"></div>
                        <div style="flex: 1;">
                            <div style="margin-bottom: 4px;">${item.text}</div>
                            <div style="font-size: 12px; color: ${item.priority === 'high' ? '#f093fb' : item.priority === 'medium' ? '#4facfe' : '#43e97b'}">
                                ${item.priority.toUpperCase()} PRIORITY
                            </div>
                        </div>
                    </div>
                    `).join('');
                }
            });
        }
        
        function generateDesignImprovements() {
            // Use API recommendations if available
            if (window.apiRecommendations && window.apiRecommendations.length > 0) {
                const improvements = {
                    visual: [],
                    typography: [],
                    color: [],
                    layout: []
                };
                
                // Distribute recommendations across categories
                window.apiRecommendations.forEach((rec, index) => {
                    const item = {
                        text: rec.description || rec.title,
                        priority: rec.priority || 'medium'
                    };
                    
                    if (index % 4 === 0) improvements.visual.push(item);
                    else if (index % 4 === 1) improvements.typography.push(item);
                    else if (index % 4 === 2) improvements.color.push(item);
                    else improvements.layout.push(item);
                });
                
                // Fill in with suggestions from critiques if needed
                if (window.apiCritiques && window.apiCritiques.length > 0) {
                    window.apiCritiques.forEach(critic => {
                        if (critic.points) {
                            critic.points.forEach(point => {
                                if (point.type === 'suggestion' && improvements.visual.length < 3) {
                                    improvements.visual.push({
                                        text: point.text,
                                        priority: 'medium'
                                    });
                                }
                            });
                        }
                    });
                }
                
                return improvements;
            }
            
            // Extract suggestions from critique data if available
            const suggestions = [];
            if (window.apiCritiques && window.apiCritiques.length > 0) {
                window.apiCritiques.forEach(critic => {
                    if (critic.points) {
                        critic.points.forEach(point => {
                            if (point.type === 'suggestion' || point.type === 'weakness') {
                                suggestions.push(point.text);
                            }
                        });
                    }
                });
            }
            
            // Generate improvements based on suggestions or use defaults
            return {
                visual: suggestions.slice(0, 3).map(s => ({ 
                    text: s, 
                    priority: Math.random() > 0.5 ? 'high' : 'medium' 
                })) || [
                    { text: 'Strengthen visual hierarchy through size and contrast', priority: 'high' },
                    { text: 'Reduce competing elements for clearer focus', priority: 'high' },
                    { text: 'Improve alignment and consistency', priority: 'medium' }
                ],
                typography: [
                    { text: 'Limit typeface variations for better unity', priority: 'high' },
                    { text: 'Improve readability through better spacing', priority: 'medium' },
                    { text: 'Establish clear typographic hierarchy', priority: 'medium' }
                ],
                color: [
                    { text: 'Simplify color palette for stronger impact', priority: 'medium' },
                    { text: 'Ensure accessibility compliance', priority: 'high' },
                    { text: 'Use color more strategically', priority: 'low' }
                ],
                layout: [
                    { text: 'Implement consistent grid system', priority: 'high' },
                    { text: 'Increase breathing room between elements', priority: 'medium' },
                    { text: 'Improve responsive behavior', priority: 'medium' }
                ]
            };
        }
        
        function generatePhotoImprovements() {
            return {
                visual: [
                    { text: 'Adjust exposure to reveal more detail in shadows', priority: 'high' },
                    { text: 'Crop tighter to strengthen composition', priority: 'medium' },
                    { text: 'Consider rule of thirds for better balance', priority: 'medium' }
                ],
                typography: [ // renamed to 'technical' in updateImprovementCategories
                    { text: 'Increase sharpness in key focal areas', priority: 'high' },
                    { text: 'Reduce noise in darker regions', priority: 'medium' },
                    { text: 'Adjust white balance for more natural tones', priority: 'low' }
                ],
                color: [ // renamed to 'narrative'
                    { text: 'Wait for decisive moment to capture peak action', priority: 'high' },
                    { text: 'Include more environmental context', priority: 'medium' },
                    { text: 'Focus on emotional connection with subject', priority: 'high' }
                ],
                layout: [ // renamed to 'artistic'
                    { text: 'Experiment with different angles and perspectives', priority: 'medium' },
                    { text: 'Use leading lines to guide viewer\'s eye', priority: 'high' },
                    { text: 'Create depth through foreground elements', priority: 'low' }
                ]
            };
        }
        
        function generateArtImprovements() {
            return {
                visual: [
                    { text: 'Strengthen conceptual clarity and intent', priority: 'high' },
                    { text: 'Push boundaries of medium and material', priority: 'medium' },
                    { text: 'Consider scale and installation context', priority: 'medium' }
                ],
                typography: [ // renamed to 'execution'
                    { text: 'Refine craftsmanship and finish quality', priority: 'high' },
                    { text: 'Ensure material choices support concept', priority: 'high' },
                    { text: 'Address technical inconsistencies', priority: 'medium' }
                ],
                color: [ // renamed to 'context'
                    { text: 'Deepen engagement with contemporary discourse', priority: 'high' },
                    { text: 'Consider political and social implications', priority: 'medium' },
                    { text: 'Reference art historical precedents more clearly', priority: 'low' }
                ],
                layout: [ // renamed to 'impact'
                    { text: 'Increase emotional and visceral impact', priority: 'high' },
                    { text: 'Create more memorable visual experience', priority: 'medium' },
                    { text: 'Consider audience interaction and participation', priority: 'medium' }
                ]
            };
        }
        
        function updateImprovementCategories() {
            const headers = document.querySelectorAll('.improvement-header h3');
            if (currentCritiqueMode === 'photo') {
                if (headers[0]) headers[0].textContent = 'Composition';
                if (headers[1]) headers[1].textContent = 'Technical';
                if (headers[2]) headers[2].textContent = 'Narrative';
                if (headers[3]) headers[3].textContent = 'Artistic Vision';
            } else if (currentCritiqueMode === 'art') {
                if (headers[0]) headers[0].textContent = 'Concept';
                if (headers[1]) headers[1].textContent = 'Execution';
                if (headers[2]) headers[2].textContent = 'Context';
                if (headers[3]) headers[3].textContent = 'Impact';
            } else {
                if (headers[0]) headers[0].textContent = 'Visual Hierarchy';
                if (headers[1]) headers[1].textContent = 'Typography';
                if (headers[2]) headers[2].textContent = 'Color & Contrast';
                if (headers[3]) headers[3].textContent = 'Layout & Spacing';
            }
        }

        function toggleImprovement(checkbox) {
            checkbox.classList.toggle('checked');
        }

        function toggleCategory(category) {
            const items = document.getElementById(`${category}-items`);
            items.classList.toggle('expanded');
        }

        function showPrinciple(principle) {
            document.querySelectorAll('.principle-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.principle-content').forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            const principleContent = document.getElementById(`principle-${principle}`);
            if (principleContent) {
                principleContent.classList.add('active');
                principleContent.style.display = 'block';
            }
        }

        // Tutorial system
        let tutorialStep = 0;
        const tutorialSteps = [
            { element: '.mode-selector', text: 'Choose different analysis modes for your specific needs' },
            { element: '.upload-area', text: 'Upload one or more designs for analysis' },
            { element: '.preview-image-container', text: 'Click on your design to add annotations' },
            { element: '.critique-grid', text: 'Get feedback from design masters' },
            { element: '.improvements-panel', text: 'Track actionable improvements' }
        ];

        function startTutorial() {
            document.getElementById('tutorialOverlay').style.display = 'block';
            showTutorialStep(0);
        }

        function showTutorialStep(step) {
            if (step >= tutorialSteps.length) {
                closeTutorial();
                return;
            }
            
            const stepData = tutorialSteps[step];
            const element = document.querySelector(stepData.element);
            
            if (element) {
                const rect = element.getBoundingClientRect();
                const spotlight = document.getElementById('tutorialSpotlight');
                const tooltip = document.getElementById('tutorialTooltip');
                
                spotlight.style.top = rect.top + 'px';
                spotlight.style.left = rect.left + 'px';
                spotlight.style.width = rect.width + 'px';
                spotlight.style.height = rect.height + 'px';
                
                tooltip.querySelector('p').textContent = stepData.text;
                tooltip.style.top = (rect.bottom + 20) + 'px';
                tooltip.style.left = rect.left + 'px';
            }
        }

        function nextTutorialStep() {
            tutorialStep++;
            showTutorialStep(tutorialStep);
        }

        function closeTutorial() {
            document.getElementById('tutorialOverlay').style.display = 'none';
            tutorialStep = 0;
        }

        // Initialize with a subtle animation
        window.addEventListener('load', () => {
            // Check if first time user
            if (!localStorage.getItem('tutorialCompleted')) {
                setTimeout(() => {
                    // startTutorial();
                }, 1000);
            }
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeTutorial();
            }
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 'o') {
                    e.preventDefault();
                    fileInput.click();
                }
            }
        });
    </script>
</body>
</html>